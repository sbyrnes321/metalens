# -*- coding: utf-8 -*-
"""
(C) 2015 Steven Byrnes

This is the refractive index data which winds up in grating.lua etc.
"""
import numpy as np
from scipy.interpolate import interp1d
import matplotlib.pyplot as plt

# Measured by Rob Devlin using ellipsometry. Amorphous TiO2, measured by ALD
nTiO2_data = [
    [300, 3.345145, 0.951696562],
    [308, 3.36245201, 0.722775196],
    [316, 3.32564183, 0.522696126],
    [324, 3.25518632, 0.361115891],
    [332, 3.16840055, 0.2377512],
    [340, 3.07710975, 0.147551924],
    [348, 2.98838525, 0.084265654],
    [356, 2.90608198, 0.042124238],
    [364, 2.83218365, 0.016378217],
    [372, 2.76780314, 0.003307256],
    [380, 2.71439342, 0],
    [388, 2.67321759, 0],
    [396, 2.63934987, 0],
    [404, 2.61053712, 0],
    [412, 2.58555792, 0],
    [420, 2.56361314, 0],
    [428, 2.54413697, 0],
    [436, 2.52670924, 0],
    [444, 2.51100754, 0],
    [452, 2.49677828, 0],
    [460, 2.48381813, 0],
    [468, 2.47196143, 0],
    [476, 2.46107142, 0],
    [484, 2.45103392, 0],
    [492, 2.44175267, 0],
    [500, 2.4331458, 0],
    [508, 2.42514313, 0],
    [516, 2.41768413, 0],
    [524, 2.41071625, 0],
    [532, 2.40419359, 0],
    [540, 2.39807589, 0],
    [548, 2.39232765, 0],
    [556, 2.38691744, 0],
    [564, 2.3818173, 0],
    [572, 2.3770023, 0],
    [580, 2.37245013, 0],
    [588, 2.36814072, 0],
    [596, 2.364056, 0],
    [604, 2.36017966, 0],
    [612, 2.3564969, 0],
    [620, 2.35299429, 0],
    [628, 2.34965961, 0],
    [636, 2.3464817, 0],
    [644, 2.34345037, 0],
    [652, 2.34055626, 0],
    [660, 2.33779081, 0],
    [668, 2.33514612, 0],
    [676, 2.33261493, 0],
    [684, 2.33019053, 0],
    [692, 2.32786674, 0],
    [700, 2.32563781, 0],
    [708, 2.32349844, 0],
    [716, 2.32144368, 0],
    [724, 2.31946895, 0],
    [732, 2.31756998, 0],
    [740, 2.3157428, 0],
    [748, 2.31398369, 0],
    [756, 2.3122892, 0],
    [764, 2.31065607, 0],
    [772, 2.30908129, 0],
    [780, 2.307562, 0],
    [788, 2.30609554, 0],
    [796, 2.30467941, 0],
    [804, 2.30331126, 0],
    [812, 2.30198887, 0],
    [820, 2.30071017, 0],
    [828, 2.29947319, 0],
    [836, 2.29827609, 0],
    [844, 2.29711711, 0],
    [852, 2.29599462, 0],
    [860, 2.29490705, 0],
    [868, 2.29385293, 0],
    [876, 2.29283086, 0],
    [884, 2.29183953, 0],
    [892, 2.29087768, 0],
    [900, 2.28994412, 0],
    [908, 2.28903774, 0],
    [916, 2.28815745, 0],
    [924, 2.28730225, 0],
    [932, 2.28647116, 0],
    [940, 2.28566327, 0],
    [948, 2.28487771, 0],
    [956, 2.28411363, 0],
    [964, 2.28337025, 0],
    [972, 2.28264681, 0],
    [980, 2.28194258, 0],
    [988, 2.28125689, 0],
    [996, 2.28058906, 0],
    [1004, 2.27993848, 0],
    [1012, 2.27930454, 0],
    [1020, 2.27868667, 0],
    [1028, 2.27808432, 0],
    [1036, 2.27749697, 0],
    [1044, 2.27692411, 0],
    [1052, 2.27636526, 0],
    [1060, 2.27581995, 0],
    [1068, 2.27528776, 0],
    [1076, 2.27476825, 0],
    [1084, 2.27426101, 0],
    [1092, 2.27376566, 0],
    [1100, 2.27328183, 0],
    [1108, 2.27280914, 0],
    [1116, 2.27234726, 0],
    [1124, 2.27189586, 0],
    [1132, 2.27145461, 0],
    [1140, 2.27102321, 0],
    [1148, 2.27060136, 0],
    [1156, 2.27018878, 0],
    [1164, 2.26978519, 0],
    [1172, 2.26939034, 0],
    [1180, 2.26900396, 0],
    [1188, 2.26862582, 0],
    [1196, 2.26825568, 0],
    [1204, 2.26789331, 0],
    [1212, 2.26753849, 0],
    [1220, 2.26719101, 0],
    [1228, 2.26685067, 0],
    [1236, 2.26651727, 0],
    [1244, 2.26619061, 0],
    [1252, 2.26587053, 0],
    [1260, 2.26555684, 0],
    [1268, 2.26524936, 0],
    [1276, 2.26494795, 0],
    [1284, 2.26465242, 0],
    [1292, 2.26436263, 0],
    [1300, 2.26407844, 0],
    [1308, 2.26379969, 0],
    [1316, 2.26352624, 0],
    [1324, 2.26325797, 0],
    [1332, 2.26299474, 0],
    [1340, 2.26273642, 0],
    [1348, 2.26248288, 0],
    [1452, 2.25957341, 0],
    [1460, 2.25937597, 0],
    [1468, 2.25918186, 0],
    [1476, 2.25899101, 0],
    [1484, 2.25880336, 0],
    [1492, 2.25861882, 0],
    [1500, 2.25843733, 0],
    [1508, 2.25825883, 0],
    [1516, 2.25808324, 0],
    [1524, 2.25791051, 0],
    [1532, 2.25774056, 0],
    [1540, 2.25757335, 0],
    [1548, 2.25740881, 0],
    [1556, 2.25724688, 0],
    [1564, 2.25708751, 0],
    [1572, 2.25693065, 0],
    [1580, 2.25677624, 0],
    [1588, 2.25662423, 0],
    [1596, 2.25647457, 0],
    [1604, 2.25632722, 0],
    [1612, 2.25618212, 0],
    [1620, 2.25603923, 0],
    [1628, 2.25589851, 0],
    [1636, 2.2557599, 0],
    [1644, 2.25562337, 0],
    [1652, 2.25548888, 0],
    [1660, 2.25535639, 0],
    [1668, 2.25522585, 0],
    [1676, 2.25509723, 0],
    [1684, 2.25497049, 0],
    [1692, 2.25484559, 0],
    [1700, 2.2547225, 0]]

nTiO2 = interp1d([x[0] for x in nTiO2_data], [x[1] + x[2] * 1j for x in nTiO2_data], kind='linear')

if False:
    xs = np.linspace(300, 1700, num=10000)
    plt.figure()
    plt.plot(xs, nTiO2(xs).real)
    plt.plot(xs, nTiO2(xs).imag)

if False:
    for x in [450,500,525,550,575,580,600,625,650]:
        assert nTiO2(x).imag == 0
        print('TiO2 @', x, 'nm,',  round(float(nTiO2(x).real),3))

# UV grade fused silica
# from Thorlabs website:
# https://www.thorlabs.com/NewGroupPage9_PF.cfm?Guide=10&Category_ID=155&ObjectGroup_ID=6249
nSiO2 = [
    [450, 1.46554],
    [500, 1.462299],
    [525, 1.461009],
    [550, 1.459883],
    [575, 1.458891],
    [580, 1.458706],
    [600, 1.458009],
    [625, 1.457219],
    [650, 1.456506]]

if False:
    for x,y in nSiO2:
        print('SiO2 @', x, 'nm,', round(y,3))
